ideapod_group.py的伪代码：

# 1. 数据预处理函数
- 日期转换格式
- json储存以及pandas数据格式

# 2. 数据清洗和转换函数:
    # 将pandas DataFrame转换为可JSON序列化的字典
    # 处理特殊数据类型（如datetime、NaN等）
    # 处理时间类型列
    # 处理时间类型的索引
    # 将NaN替换为None
    return 转换后的字典

# 3. 财务分析函数
def analyze_finance(space_df, catering_df):
    # 3.1 收入分类函数
    def categorize_incomes(row):
        # 根据支付方式和备注对收入进行分类
        # 返回：月结收入、最福利收入、大众点评收入、拍摄收入

    # 3.2 日度分析
    # 处理餐饮数据
    # 处理空间预订数据
    # 合并外部数据（书玉数据）
    # 计算调整后的收入
    # 计算各项收入：
    #   - 吧台非月结场景收入
    #   - 吧台餐饮收入
    #   - 场景收入
    #   - 餐饮收入

    # 3.3 周度分析
    # 将日度数据转换为周度数据
    # 计算各项收入的周度汇总
    # 计算过去4周的收入
    # 计算周环比（WoW）
    # 计算月环比（MoM）

    return 分析结果

# 4. 主函数
def analyze(conn):
    # 4.1 数据获取
    # 从数据库读取餐饮和空间预订数据

    # 4.2 数据预处理
    # 处理时间格式
    # 添加日期相关列（月、周、日）
    # 剔除支付时间为NA的记录

    # 4.3 执行财务分析
    # 调用analyze_finance函数

    # 4.4 结果处理
    # 将结果转换为JSON格式
    return 处理后的结果

ideapod_fetch.py的伪代码：
# 1. 数据读取：四个CSV文件

# 2. 列名重命名和删除
# 重命名列
catering_df.rename(columns={'入账时间（原下单时间）': '下单时间'})
space_df.rename(columns={'支付金额1': '场景实收_flipos', '支付金额2': '场景实收_non_flipos'})
# 删除不需要的列


# 3. 数据清洗
# 3.1 餐饮数据清洗
# 过滤掉服务方式为"报损"的记录
catering_df = catering_df[catering_df['服务方式'] != '报损']

# 3.2 支付方式处理
# 定义支付方式映射字典，并映射到支付方式1和支付方式2.
字典：
    5: 'flipos',
    7: '最福利积分',
    6: '内部员工',
    4: '大众点评',
    8: '预充值',
    10: '月结'

# 3.3 处理员工录入错误：
# 逻辑1.1：处理双flipos支付情况
if (支付方式2 == 'flipos' and 支付方式1 == 'flipos'):
    合并支付金额到场景实收_flipos
    清空支付方式2和场景实收_non_flipos

# 逻辑1.2：处理flipos和大众点评组合
if (支付方式2 == 'flipos' and 支付方式1 == '大众点评'):
    交换支付方式1和支付方式2
    交换对应的支付金额

# 逻辑2.1：处理非flipos支付情况
if (支付方式1不是NA且不是flipos and 支付方式2是NA):
    交换支付方式1和支付方式2
    交换对应的支付金额

# 逻辑2.2：处理相同支付方式
if (支付方式1 == 支付方式2 或 特定条件):
    合并支付金额到场景实收_non_flipos
    更新支付方式2
    清空支付方式1和场景实收_flipos

# 3.4. 产品数据清洗
# 清理商品名和产品类型的空白字符
product_df['商品名'] = 清理空白字符
product_df['产品类型'] = 清理空白字符
# 填充空值
product_df[特定列] = 填充空值('')

# 4. 数据格式化
- 日期
- 换行符
- 会员号和手机号

# 5. 空间预订数据特殊处理
# 处理实际结束时间
if "实际结束时间" in space_df:
    space_df['实际结束时间'] = 填充NA值

# 6. 商品名称标准化
# 清理和标准化订单商品名
space_df['订单商品名'] = 清理商品名
space_df['订单商品名'] = 替换特定名称

# 7. 对四个表设置主键，建立索引
catering_df.set_index("会员号")
member_df.set_index("会员号")
product_df.set_index("商品名")
space_df.set_index("手机号")

# 8. 会员等级处理
# 合并会员数据并处理等级
space_df = 合并会员数据
space_df['等级'] = 填充未注册用户

# 9. 数据保存
# 将处理后的数据保存到SQLite数据库
